{"ast":null,"code":"import _toConsumableArray from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{Button}from\"react-bootstrap\";import{programs,credentials,remove,change,logout}from'./UserFunctions';import{CopyToClipboard}from'react-copy-to-clipboard';import{Cookie}from'js-cookie';import\"./Programs.css\";var ProgramsList=/*#__PURE__*/function(_Component){_inherits(ProgramsList,_Component);function ProgramsList(props){var _this;_classCallCheck(this,ProgramsList);_this=_possibleConstructorReturn(this,_getPrototypeOf(ProgramsList).call(this,props));_this.resetFormState=function(){_this.setState({formState:{alertMessage:'',program:'',username:'',password:'',password_re:'',mode:\"submit\",idx:''}});};_this.onChange=function(e){_this.setState({formState:_objectSpread({},_this.state.formState,_defineProperty({},e.target.name,e.target.value))});};_this.onSubmit=function(e){var _this$state=_this.state,programList=_this$state.programList,formState=_this$state.formState;e.preventDefault();var program=e.target.querySelector(\"input[name='program']\").value;var username=e.target.querySelector(\"input[name='username']\").value;var password=e.target.querySelector(\"input[name='password']\").value;var password_re=e.target.querySelector(\"input[name='password_re']\").value;var index=0;if(formState.mode===\"submit\"){if(programList.length!==0){var len=_this.state.programList.length;index=_this.state.programList[len-1].idx+1;}var credentialSet={program:program,username:username,password:password,index:index};_this.addCredentials(credentialSet);_this.setState({programList:[].concat(_toConsumableArray(_this.state.programList),[{program:program,username:username,password:password,password_re:password_re,updating:false,idx:index}])});}else if(formState.mode===\"edit\"){index=programList.find(function(item){return item.idx===formState.idx;}).idx;programList[index]={program:program,username:username,password:password,updating:false,idx:programList[index].idx};var _credentialSet={program:program,username:username,password:password,index:programList[index].idx};_this.addCredentials(_credentialSet);_this.setState({programList:_toConsumableArray(programList)});}};_this.updateCredentials=function(key){var programList=_this.state.programList;//key luulee olevansa juokseva indexi, mutta se on staattiten item.idx\n//muuta tämä indexillä etsimisestä pointterilla etsimiseen\n//map(programlist, key) -> sieltä keytä vastaava lista\nconsole.log(key);console.log(programList[key]);var thereal=programList.find(function(item){return item.idx===key;});console.log(thereal);programList[key].updating=true;_this.setState({formState:_objectSpread({},_this.state.programList[key],{mode:\"edit\"}),programList:programList});};_this.deleteCredentials=function(key){console.log(key);var programList=_this.state.programList;var removed=programList.splice(key,1);var removeProgram={program:removed[0].program,username:removed[0].username};remove(removeProgram).then(function(res){if(!res.err){_this.setState({programList:_toConsumableArray(programList)});}}).catch(function(err){_this.props.history.push('/');});};_this.authorizationCheck=function(responseData){switch(responseData.status){case 401:return _this.logOut(responseData);case 500:return _this.logOut(responseData);case 422:return _this.logOut(responseData);default:return{};}};_this.state={programList:[],//store initial list of programs and credentials\nmakeChanges:false,//true if user wants to change existing credentials \nformState:{alertMessage:'',idx:'',program:'',username:'',password:'',password_re:'',mode:\"submit\"}};_this.getToken=_this.getToken.bind(_assertThisInitialized(_this));//get token from local storage\nreturn _this;}_createClass(ProgramsList,[{key:\"addCredentials\",value:function addCredentials(credentialSet){var _this2=this;var formState=this.state.formState;if(formState.mode==='submit'){credentials(credentialSet).then(function(res){_this2.authorizationCheck(res);if(!res.err){_this2.resetFormState();}}).catch(function(err){console.log(err);});}else if(formState.mode==='edit'){change(credentialSet).then(function(res){_this2.authorizationCheck(res);if(!res.err){_this2.resetFormState();}}).catch(function(err){_this2.props.history.push('/');console.log(err);});}}},{key:\"getToken\",value:function getToken(){return localStorage.getItem('jwt-token');}},{key:\"validateForm\",value:function validateForm(formState){if(formState.program.length>0&&formState.username.length>0&&formState.password.length>0){return formState.password===formState.password_re;}return false;}},{key:\"componentDidMount\",value:function componentDidMount(){var _this3=this;var token=this.getToken();programs(token).then(function(res){_this3.authorizationCheck(res);if(!res.err){_this3.setState({programList:res.data.programs});}}).catch(function(error){console.log(error.response.data);_this3.props.history.push('/');});}},{key:\"logOut\",value:function logOut(responseData){if(responseData){Cookie.remove('token');localStorage.removeItem('jwt-token');return this.props.history.push({pathname:'/',state:responseData.data.msg});}else{return this.props.history.push('/');}}},{key:\"titleChange\",value:function titleChange(){var formState=this.state.formState;var title='Add';if(formState.mode==='edit'){title='Edit';}return title;}},{key:\"alertMessage\",value:function alertMessage(){var formState=this.state.formState;if(formState.program.length===0){return'Enter application name';}else if(formState.username.length===0){return'Enter your username for the application';}else if(formState.password.length===0){return'Enter your password for the application';}else if(formState.password_re===''){if(formState.password_re.length===0){return'Enter your password again';}}else if(formState.password!==formState.password_re){return'Passwords has to match';}else if(formState.password.length<8){return'Recommended password length is 8 digits';}else if(formState.mode==='submit'){return'Good job! Now you can submit your credentials';}else{return\"Save your credentials by clicking 'edit'\";}}},{key:\"render\",value:function render(){var _this4=this;var _this$state2=this.state,programList=_this$state2.programList,formState=_this$state2.formState;return React.createElement(\"div\",{className:\"Programs\"},React.createElement(\"div\",{className:\"top-row\"},React.createElement(\"div\",{className:\"logout\"},React.createElement(Button,{className:\"logout-btn\",onClick:function onClick(){return _this4.logOut();}},\"Logout\"))),React.createElement(\"h1\",{className:\"title\"},\"KEYBANK\"),React.createElement(\"div\",{className:\"programtable\"},React.createElement(Table,{programList:programList,updateCredentials:this.updateCredentials,deleteCredentials:this.deleteCredentials})),React.createElement(\"div\",{className:\"addform\"},React.createElement(\"h3\",{className:\"form-title\"},\" \",this.titleChange(),\" credentials\"),React.createElement(Form,{formState:formState,onChange:this.onChange,onSubmit:this.onSubmit,validateForm:this.validateForm,resetFormState:this.resetFormState}),React.createElement(\"p\",{className:\"alert-msg\"},this.alertMessage())));}}]);return ProgramsList;}(Component);var Table=function Table(_ref){var _ref$programList=_ref.programList,programList=_ref$programList===void 0?[]:_ref$programList,updateCredentials=_ref.updateCredentials,deleteCredentials=_ref.deleteCredentials;if(!programList.length>0){return React.createElement(\"p\",null,\"Start by adding new credentials\");}return React.createElement(\"table\",null,React.createElement(\"tr\",null,React.createElement(\"th\",null,\"Application\"),React.createElement(\"th\",null,\"Username\"),React.createElement(\"th\",null,\"Password\"),React.createElement(\"th\",null,\"Actions\")),programList.map(function(item){console.log(item.idx);return React.createElement(\"tr\",null,React.createElement(\"td\",null,React.createElement(\"p\",null,item.program)),React.createElement(\"td\",null,React.createElement(\"p\",null,item.username)),React.createElement(\"td\",null,React.createElement(\"p\",null,\"****\")),React.createElement(\"td\",{className:\"btn-col\"},React.createElement(CopyToClipboard,{text:item.password},React.createElement(Button,{className:\"table-btn\"},\"copy\")),React.createElement(Button,{className:\"table-btn\",onClick:function onClick(){return updateCredentials(item.idx);}},\"edit\"),React.createElement(Button,{className:\"table-btn\",onClick:function onClick(){return deleteCredentials(item.idx);}},\"del\")));}));};var Field=function Field(_ref2){var _ref2$label=_ref2.label,label=_ref2$label===void 0?\"\":_ref2$label,_ref2$name=_ref2.name,name=_ref2$name===void 0?\"\":_ref2$name,_ref2$value=_ref2.value,value=_ref2$value===void 0?\"\":_ref2$value,_ref2$type=_ref2.type,type=_ref2$type===void 0?\"\":_ref2$type,onChange=_ref2.onChange;return React.createElement(\"div\",{className:\"field-set\"},React.createElement(\"label\",{className:\"field-label\",htmlFor:name},label),React.createElement(\"input\",{className:\"field-input\",type:type,name:name,value:value,onChange:onChange}));};var Form=function Form(_ref3){var formState=_ref3.formState,onChange=_ref3.onChange,onSubmit=_ref3.onSubmit,validateForm=_ref3.validateForm,resetFormState=_ref3.resetFormState;return React.createElement(\"form\",{className:\"form\",onSubmit:onSubmit},React.createElement(\"fieldset\",null,React.createElement(Field,{name:\"program\",label:\"Application\",type:\"text\",value:formState.program,onChange:onChange}),React.createElement(Field,{name:\"username\",label:\"Username\",type:\"text\",value:formState.username,onChange:onChange}),React.createElement(Field,{name:\"password\",label:\"Password\",type:\"password\",value:formState.password,onChange:onChange}),React.createElement(Field,{name:\"password_re\",label:\"Password again\",type:\"password\",value:formState.password_re,onChange:onChange})),React.createElement(\"div\",{className:\"button-group\"},React.createElement(Button,{className:\"form-btn\",type:formState.mode,disabled:!validateForm(formState)},formState.mode),React.createElement(Button,{className:\"form-btn\",block:true,bsSize:\"large\",onClick:function onClick(){return resetFormState();}},\"clear\")));};export default ProgramsList;","map":{"version":3,"sources":["/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/src/components/Programs.js"],"names":["React","Component","Button","programs","credentials","remove","change","logout","CopyToClipboard","Cookie","ProgramsList","props","resetFormState","setState","formState","alertMessage","program","username","password","password_re","mode","idx","onChange","e","state","target","name","value","onSubmit","programList","preventDefault","querySelector","index","length","len","credentialSet","addCredentials","updating","find","item","updateCredentials","key","console","log","thereal","deleteCredentials","removed","splice","removeProgram","then","res","err","catch","history","push","authorizationCheck","responseData","status","logOut","makeChanges","getToken","bind","localStorage","getItem","token","data","error","response","removeItem","pathname","msg","title","titleChange","validateForm","Table","map","Field","label","type","Form"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { Button } from \"react-bootstrap\"\nimport { programs, credentials, remove, change, logout } from './UserFunctions'\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\nimport { Cookie } from 'js-cookie'\n\nimport \"./Programs.css\"\n\nclass ProgramsList extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            programList: [], //store initial list of programs and credentials\n            makeChanges: false, //true if user wants to change existing credentials \n            formState: {\n                alertMessage: '',\n                idx: '',\n                program: '', \n                username: '',\n                password:'',\n                password_re:'',\n                mode: \"submit\",\n            }\n        }\n        this.getToken = this.getToken.bind(this) //get token from local storage\n\n    }\n\n    resetFormState = () => {\n        this.setState({\n            formState:{\n                alertMessage: '',\n                program: '',\n                username: '',\n                password: '',\n                password_re: '',\n                mode: \"submit\",\n                idx: ''\n            }\n        })\n    }\n    \n    onChange = e => {\n        this.setState({\n            formState:{\n                ...this.state.formState,\n            \n                [e.target.name]: e.target.value\n            }\n        })\n    }\n\n    onSubmit = e => {\n        const { programList, formState } = this.state\n        e.preventDefault()\n        const program = e.target.querySelector(\"input[name='program']\").value      \n        const username = e.target.querySelector(\"input[name='username']\").value      \n        const password = e.target.querySelector(\"input[name='password']\").value      \n        const password_re = e.target.querySelector(\"input[name='password_re']\").value\n        let index = 0\n        if(formState.mode === \"submit\"){\n            if(programList.length !== 0){\n                const len = this.state.programList.length\n                index = this.state.programList[len-1].idx +1  \n            }\n            const credentialSet = {\n                program: program,\n                username: username,\n                password: password,\n                index: index\n            } \n            this.addCredentials(credentialSet)\n            this.setState({\n                programList: [\n                    ...this.state.programList,\n                    {\n                        program,\n                        username,\n                        password,\n                        password_re,\n                        updating: false,\n                        idx: index\n                    }\n                ]\n            })\n                \n\n        \n        } else if (formState.mode === \"edit\"){\n\n            index = programList.find((item) => item.idx === formState.idx).idx\n\n            \n            programList[index] = {\n                program,\n                username,\n                password,\n                updating: false,\n                idx:programList[index].idx\n            }\n                        \n            const credentialSet = {\n                program: program,\n                username: username,\n                password: password,\n                index: programList[index].idx\n            } \n            this.addCredentials(credentialSet)\n            this.setState({\n                programList: [...programList]\n            })    \n        }\n    }\n\n    addCredentials(credentialSet){\n        const { formState } = this.state\n\n        if (formState.mode === 'submit'){\n            \n            credentials(credentialSet)\n            .then(res => {\n                this.authorizationCheck(res)\n                if(!res.err){\n                    this.resetFormState()\n                }\n            })\n            .catch(err => {\n                console.log(err)\n            })\n        } else if (formState.mode === 'edit'){\n            change(credentialSet)\n            .then(res => {\n                this.authorizationCheck(res)\n                if(!res.err){\n                    this.resetFormState()\n                }\n            })\n            .catch(err => {\n                this.props.history.push('/')\n                console.log(err)\n            })\n        }\n    }\n\n    updateCredentials = key => {\n        \n        let { programList } = this.state\n        //key luulee olevansa juokseva indexi, mutta se on staattiten item.idx\n        //muuta tämä indexillä etsimisestä pointterilla etsimiseen\n        //map(programlist, key) -> sieltä keytä vastaava lista\n        console.log(key)\n        console.log(programList[key])\n        let thereal = programList.find((item) => {\n            return item.idx === key\n        })\n        console.log(thereal)\n        programList[key].updating = true \n        this.setState({\n            formState: { ...this.state.programList[key], mode: \"edit\"},\n            programList\n        })\n    }\n\n    deleteCredentials = key => {\n        console.log(key)\n        let { programList } = this.state\n        var removed = programList.splice(key, 1)\n        const removeProgram = {\n            program: removed[0].program,\n            username: removed[0].username,\n        }\n        remove(removeProgram).then(res => {\n            if(!res.err){\n                this.setState({\n                    programList: [...programList]\n                })\n            }\n        }).catch(err => {\n            this.props.history.push('/')\n        })\n\n    }\n   \n    getToken(){\n        return localStorage.getItem('jwt-token')\n    }\n\n    validateForm(formState){\n        if (formState.program.length > 0 && formState.username.length > 0 && formState.password.length > 0) {\n\n            return formState.password === formState.password_re\n        }\n        return false\n    }\n\n\n    componentDidMount() {\n        const token = this.getToken()\n        programs(token).then(res => {\n            this.authorizationCheck(res)      \n            if(!res.err) {\n                this.setState({\n                    programList: res.data.programs\n                })  \n            }\n        }).catch(error =>{\n            console.log(error.response.data)\n            this.props.history.push('/')        \n        })\n    }\n\n    logOut(responseData){\n        if (responseData){\n\n            Cookie.remove('token')\n            localStorage.removeItem('jwt-token')\n            return this.props.history.push({\n                pathname: '/',\n                state: responseData.data.msg\n            }) \n        }\n        else {\n            return this.props.history.push('/')\n            \n        }\n    }\n    \n\n    authorizationCheck = responseData => {\n        switch (responseData.status){\n            case 401: \n                return this.logOut(responseData)\n            case 500:\n                return this.logOut(responseData)\n            case 422:\n                return this.logOut(responseData)\n            default:\n                return {}\n        }\n        \n    }\n    \n    titleChange(){\n        let { formState } = this.state\n        let title = 'Add'\n\n        if (formState.mode === 'edit'){\n            title = 'Edit'\n        } \n        return title\n    }\n\n    alertMessage(){\n        \n        let { formState } = this.state\n\n        if (formState.program.length === 0){\n            return 'Enter application name'\n        } else if(formState.username.length === 0) {\n            return 'Enter your username for the application'\n        } else if(formState.password.length === 0){\n            return 'Enter your password for the application'\n        } else if(formState.password_re === ''){\n            if(formState.password_re.length === 0){\n                return 'Enter your password again'\n        } \n        } else if (formState.password !== formState.password_re){\n            return 'Passwords has to match'\n        } else if (formState.password.length < 8) {\n            return 'Recommended password length is 8 digits'\n        } else if (formState.mode === 'submit') {\n            return 'Good job! Now you can submit your credentials'\n        } else {\n            return \"Save your credentials by clicking 'edit'\"\n        }\n        \n        \n    }\n\n   \n    render(){\n        const { programList, formState } = this.state\n        return (\n\n            <div className=\"Programs\">\n                <div className=\"top-row\">\n\n                    <div className=\"logout\">\n                        <Button className=\"logout-btn\" onClick={() => this.logOut()}>\n                            Logout\n                        </Button>\n                    </div>\n                </div>\n                <h1 className=\"title\">KEYBANK</h1>\n                <div className=\"programtable\">\n                    <Table\n                        programList={programList}\n                        updateCredentials={this.updateCredentials}\n                        deleteCredentials={this.deleteCredentials}\n                    />\n                </div>\n                <div className=\"addform\">\n                    <h3 className=\"form-title\"> {this.titleChange()} credentials</h3>\n                    <Form\n                        formState={formState}\n                        onChange={this.onChange}\n                        onSubmit={this.onSubmit}\n                        validateForm={this.validateForm}\n                        resetFormState={this.resetFormState}\n                    />\n                    <p className=\"alert-msg\">{this.alertMessage()}</p>\n                </div>\n            </div>\n        )\n    }   \n}\nconst Table =({ programList=[], updateCredentials, deleteCredentials }) =>{\n    if (!programList.length > 0){\n        return <p>Start by adding new credentials</p>\n    }\n    return(\n        <table>\n            <tr>\n                <th>Application</th>\n                <th>Username</th>\n                <th>Password</th>\n                <th>Actions</th>\n            </tr>\n            \n            {programList.map((item) => {\n                console.log(item.idx)\n                return (            \n                <tr>\n                    <td>\n                        <p>{item.program}</p>\n                    </td>\n                    <td>\n                        <p>{item.username}</p>\n                    </td>\n                    <td >\n                        <p>****</p>\n                    </td>\n                    <td className=\"btn-col\">\n                        <CopyToClipboard text={item.password} >\n                            <Button className=\"table-btn\">\n                                copy\n                            </Button>\n                        </CopyToClipboard>\n                        <Button className=\"table-btn\"  onClick={() => updateCredentials(item.idx)}>\n                            edit\n                        </Button>\n                        <Button className=\"table-btn\"  onClick={() => deleteCredentials(item.idx)}>\n                            del\n                        </Button>\n                    </td>\n                </tr>\n                )\n            })}\n    </table>\n    )\n}\n\nconst Field = ({label =\"\", name=\"\", value=\"\", type=\"\", onChange}) =>{\n        return(<div className=\"field-set\">\n            <label className=\"field-label\" htmlFor={name}>{label}</label>\n            <input className=\"field-input\" type={type} name={name} value={value} onChange={onChange}/>\n        </div>\n        )}\n\nconst Form = ({ formState, onChange, onSubmit, validateForm, resetFormState }) => {\n    \n\n    return (\n\n            <form className=\"form\" onSubmit={onSubmit}>\n                <fieldset>\n                    <Field \n                        name=\"program\"\n                        label=\"Application\"\n                        type=\"text\"\n                        value={formState.program}\n                        onChange={onChange}\n                    />\n                    <Field \n                        name=\"username\"\n                        label=\"Username\"\n                        type=\"text\"\n                        value={formState.username}\n                        onChange={onChange}\n                    />\n                    <Field \n                        name=\"password\"\n                        label=\"Password\"\n                        type=\"password\"\n                        value={formState.password}\n                        onChange={onChange}\n                    />\n                    <Field\n                        name=\"password_re\"\n                        label=\"Password again\"\n                        type=\"password\"\n                        value={formState.password_re}\n                        onChange={onChange}\n                    />\n                </fieldset>\n\n                <div className=\"button-group\">\n                    <Button className=\"form-btn\" type={formState.mode} disabled={!validateForm(formState)}>\n                        {formState.mode}\n                    </Button>\n                    <Button className=\"form-btn\" block bsSize=\"large\" onClick={() => resetFormState()}>\n                        clear\n                    </Button>\n                </div>\n            </form>\n\n    )      \n}\n    \nexport default ProgramsList"]},"metadata":{},"sourceType":"module"}