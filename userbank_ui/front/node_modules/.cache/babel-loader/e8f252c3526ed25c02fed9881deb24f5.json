{"ast":null,"code":"import _toConsumableArray from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/node_modules/@babel/runtime/helpers/esm/inherits\";var _this4=this;import React,{Component}from'react';import{Button}from\"react-bootstrap\";import{programs,credentials,remove,change}from'./UserFunctions';import\"./Programs.css\";var ProgramsList=/*#__PURE__*/function(_Component){_inherits(ProgramsList,_Component);function ProgramsList(props){var _this;_classCallCheck(this,ProgramsList);_this=_possibleConstructorReturn(this,_getPrototypeOf(ProgramsList).call(this,props));_this.resetFormState=function(){_this.setState({formState:{program:'',username:'',password:'',password_re:'',mode:\"submit\",idx:''}});};_this.onChange=function(e){_this.setState({formState:_objectSpread({},_this.state.formState,_defineProperty({},e.target.name,e.target.value))});};_this.onSubmit=function(e){var _this$state=_this.state,programList=_this$state.programList,formState=_this$state.formState;console.log(programList);console.log(formState);e.preventDefault();var program=e.target.querySelector(\"input[name='program']\").value;var username=e.target.querySelector(\"input[name='username']\").value;var password=e.target.querySelector(\"input[name='password']\").value;var password_re=e.target.querySelector(\"input[name='password_re']\").value;var index=0;if(formState.mode===\"submit\"){if(programList.length!==0){var len=_this.state.programList.length;index=_this.state.programList[len-1].idx+1;}_this.setState({programList:[].concat(_toConsumableArray(_this.state.programList),[{program:program,username:username,password:password,password_re:password_re,updating:false,idx:index}])});var credentialSet={program:program,username:username,password:password,index:index};_this.addCredentials(credentialSet);}else if(formState.mode===\"edit\"){var _index=programList.find(function(item){return item.idx===formState.idx;}).idx;console.log(_index);console.log(programList[_index]);programList[_index]={program:program,username:username,password:password,updating:false,idx:programList[_index].idx};_this.setState({programList:_toConsumableArray(programList)});var _credentialSet={program:program,username:username,password:password,index:programList[_index].idx};_this.addCredentials(_credentialSet);}};_this.updateCredentials=function(key){var programList=_this.state.programList;console.log(programList[key]);programList[key].updating=true;_this.setState({formState:_objectSpread({},_this.state.programList[key],{mode:\"edit\"}),programList:programList});};_this.deleteCredentials=function(key){var programList=_this.state.programList;var removed=programList.splice(key,1);console.log(removed[0]);var removeProgram={program:removed[0].program,username:removed[0].username};remove(removeProgram).then(function(res){if(!res.err){_this.setState({programList:_toConsumableArray(programList)});}});};_this.state={programList:[],//store initial list of programs and credentials\nmakeChanges:false,//true if user wants to change existing credentials \nprogramChanges:[],formState:{idx:'',program:'',username:'',password:'',password_re:'',mode:\"submit\"}};_this.getToken=_this.getToken.bind(_assertThisInitialized(_this));//get token from local storage\nreturn _this;}_createClass(ProgramsList,[{key:\"addCredentials\",value:function addCredentials(credentialSet){var _this2=this;var formState=this.state.formState;if(formState.mode==='submit'){credentials(credentialSet).then(function(res){if(!res.err){_this2.resetFormState();}});}else if(formState.mode==='edit'){change(credentialSet).then(function(res){if(!res.err){_this2.resetFormState();}});}}},{key:\"getToken\",value:function getToken(){return localStorage.getItem('jwt-token');}},{key:\"validateForm\",value:function validateForm(formState){if(formState.password.length>0&&formState.password_re.length>0){return formState.password===formState.password_re;}}},{key:\"componentDidMount\",value:function componentDidMount(){var _this3=this;var token=this.getToken();if(!token){this.props.history.push('/');}programs(token).then(function(res){if(!res.err){_this3.setState({programList:res.programs});}}).catch(function(err){_this3.props.history.push('/');});}},{key:\"render\",value:function render(){var _this$state2=this.state,programList=_this$state2.programList,formState=_this$state2.formState;return React.createElement(\"div\",{className:\"Programs\"},React.createElement(\"h1\",null,\"KEYBANK\"),React.createElement(\"div\",{className:\"programtable\"},React.createElement(Table,{programList:programList,updateCredentials:this.updateCredentials,deleteCredentials:this.deleteCredentials})),React.createElement(\"div\",{className:\"addform\"},React.createElement(Form,{formState:formState,onChange:this.onChange,onSubmit:this.onSubmit//validateForm={this.validateForm}\n})));}}]);return ProgramsList;}(Component);var Table=function Table(_ref){var _ref$programList=_ref.programList,programList=_ref$programList===void 0?[]:_ref$programList,updateCredentials=_ref.updateCredentials,deleteCredentials=_ref.deleteCredentials;console.log(_this4.state.programList);if(_this4.state.programList.length<1){return React.createElement(\"p\",null,\"Start by adding new credentials\");}return React.createElement(\"table\",null,React.createElement(\"tr\",null,React.createElement(\"th\",null,\"Program\"),React.createElement(\"th\",null,\"Username\"),React.createElement(\"th\",null,\"Password\"),React.createElement(\"th\",null,\"Actions\")),programList.map(function(item,key){return React.createElement(\"tr\",null,React.createElement(\"td\",null,React.createElement(\"p\",null,item.program)),React.createElement(\"td\",null,React.createElement(\"p\",null,item.username)),React.createElement(\"td\",null,React.createElement(\"p\",null,item.password)),React.createElement(\"td\",null,React.createElement(Button,{className:\"edit-btn\",block:true,bsSize:\"large\",onClick:function onClick(){return updateCredentials(key);}},\"edit\"),React.createElement(Button,{className:\"delete-btn\",block:true,bsSize:\"large\",onClick:function onClick(){return deleteCredentials(key);}},\"delete\")));}));};var Field=function Field(_ref2){var _ref2$label=_ref2.label,label=_ref2$label===void 0?\"\":_ref2$label,_ref2$name=_ref2.name,name=_ref2$name===void 0?\"\":_ref2$name,_ref2$value=_ref2.value,value=_ref2$value===void 0?\"\":_ref2$value,onChange=_ref2.onChange;return React.createElement(\"div\",{className:\"field-set\"},React.createElement(\"label\",{className:\"field-label\",htmlFor:name},label),React.createElement(\"input\",{className:\"field-input\",type:\"text\",name:name,value:value,onChange:onChange}));};var Form=function Form(_ref3){var formState=_ref3.formState,onChange=_ref3.onChange,onSubmit=_ref3.onSubmit,validateForm=_ref3.validateForm;return React.createElement(\"form\",{className:\"form\",onSubmit:onSubmit},React.createElement(\"fieldset\",null,React.createElement(Field,{name:\"program\",label:\"Program\",value:formState.program,onChange:onChange}),React.createElement(Field,{name:\"username\",label:\"Username\",value:formState.username,onChange:onChange}),React.createElement(Field,{name:\"password\",label:\"Password\",value:formState.password,onChange:onChange}),React.createElement(Field,{name:\"password_re\",label:\"Password again\",value:formState.password_re,onChange:onChange})),React.createElement(\"div\",{className:\"button-group\"},React.createElement(Button,{type:formState.mode},formState.mode)));};export default ProgramsList;","map":{"version":3,"sources":["/home/julius/.local/lib/python3.6/site-packages/userbank/userbank_ui/front/src/components/Programs.js"],"names":["React","Component","Button","programs","credentials","remove","change","ProgramsList","props","resetFormState","setState","formState","program","username","password","password_re","mode","idx","onChange","e","state","target","name","value","onSubmit","programList","console","log","preventDefault","querySelector","index","length","len","updating","credentialSet","addCredentials","find","item","updateCredentials","key","deleteCredentials","removed","splice","removeProgram","then","res","err","makeChanges","programChanges","getToken","bind","localStorage","getItem","token","history","push","catch","Table","map","Field","label","Form","validateForm"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { Button } from \"react-bootstrap\"\nimport { programs, credentials, remove, change } from './UserFunctions'\n\n\nimport \"./Programs.css\"\n\n\nclass ProgramsList extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            programList: [], //store initial list of programs and credentials\n            makeChanges: false, //true if user wants to change existing credentials \n            programChanges: [],\n\n            formState: {\n                idx: '',\n                program: '', \n                username: '',\n                password:'',\n                password_re:'',\n                mode: \"submit\",\n            }\n\n\n        }\n        this.getToken = this.getToken.bind(this) //get token from local storage\n    }\n\n    resetFormState = () => {\n        this.setState({\n            formState:{\n                program: '',\n                username: '',\n                password: '',\n                password_re: '',\n                mode: \"submit\",\n                idx: ''\n            }\n        })\n    }\n    \n    onChange = e => {\n        this.setState({\n            formState:{\n                ...this.state.formState,\n            \n                [e.target.name]: e.target.value\n            }\n        })\n    }\n\n    onSubmit = e => {\n        const { programList, formState } = this.state\n        console.log(programList)\n        console.log(formState)\n        e.preventDefault()\n        const program = e.target.querySelector(\"input[name='program']\").value      \n        const username = e.target.querySelector(\"input[name='username']\").value      \n        const password = e.target.querySelector(\"input[name='password']\").value      \n        const password_re = e.target.querySelector(\"input[name='password_re']\").value\n        let index = 0\n        if(formState.mode === \"submit\"){\n            if(programList.length !== 0){\n                const len = this.state.programList.length\n                index = this.state.programList[len-1].idx +1  \n            }\n            \n            this.setState({\n                programList: [\n                    ...this.state.programList,\n                    {\n                        program,\n                        username,\n                        password,\n                        password_re,\n                        updating: false,\n                        idx: index\n                    }\n                ]\n            })\n            const credentialSet = {\n                program: program,\n                username: username,\n                password: password,\n                index: index\n            } \n            this.addCredentials(credentialSet)\n        \n        } else if (formState.mode === \"edit\"){\n\n            const index = programList.find((item) => item.idx === formState.idx).idx\n            console.log(index)\n            console.log(programList[index])\n            \n            programList[index] = {\n                program,\n                username,\n                password,\n                updating: false,\n                idx:programList[index].idx\n            }\n            this.setState({\n                programList: [...programList]\n            })\n            const credentialSet = {\n                program: program,\n                username: username,\n                password: password,\n                index: programList[index].idx\n            } \n            this.addCredentials(credentialSet)\n\n        }\n\n    }\n\n    addCredentials(credentialSet){\n        const { formState } = this.state\n\n        if (formState.mode === 'submit'){\n            credentials(credentialSet).then(res => {\n                if(!res.err){\n                    this.resetFormState()\n                }\n            })\n        } else if (formState.mode === 'edit'){\n            change(credentialSet).then(res => {\n                if(!res.err){\n                    this.resetFormState()\n                }\n            })\n        }\n    }\n\n    updateCredentials = key => {\n        let { programList } = this.state\n        console.log(programList[key])\n        programList[key].updating = true\n        this.setState({\n            formState: { ...this.state.programList[key], mode: \"edit\"},\n            programList\n        })\n    }\n\n    deleteCredentials = key => {\n        let { programList } = this.state\n        var removed = programList.splice(key, 1)\n        console.log(removed[0])\n        const removeProgram = {\n            program: removed[0].program,\n            username: removed[0].username,\n        }\n        remove(removeProgram).then(res => {\n            if(!res.err){\n                this.setState({\n                    programList: [...programList]\n                })\n            }\n        })\n\n    }\n   \n    getToken(){\n        return localStorage.getItem('jwt-token')\n    }\n\n    validateForm(formState){\n        if (formState.password.length > 0 && formState.password_re.length > 0){ \n                return formState.password === formState.password_re\n        }\n    }\n\n    componentDidMount() {\n        const token = this.getToken()\n        if(!token){\n            this.props.history.push('/')\n        }\n        programs(token).then(res => {      \n            if(!res.err) {\n                this.setState({\n                    programList: res.programs\n                })  \n            }\n        }).catch(err =>{\n            this.props.history.push('/')        \n        })\n    }\n\n   \n    render(){\n        const {programList, formState} = this.state\n        return (\n            <div className=\"Programs\">\n                <h1>KEYBANK</h1>\n                <div className=\"programtable\">\n                    <Table\n                    programList={programList}\n                    updateCredentials={this.updateCredentials}\n                    deleteCredentials={this.deleteCredentials}\n                    />\n                </div>\n                <div className=\"addform\">\n                    <Form\n                    formState={formState}\n                    onChange={this.onChange}\n                    onSubmit={this.onSubmit}\n                    //validateForm={this.validateForm}\n                    />\n                </div>\n            </div>\n        )\n    }   \n}\nconst Table =({ programList=[], updateCredentials, deleteCredentials }) =>{\n    console.log(this.state.programList)\n    if (this.state.programList.length < 1){\n        return <p>Start by adding new credentials</p>\n    }\n    return(\n        <table>\n            <tr>\n                <th>Program</th>\n                <th>Username</th>\n                <th>Password</th>\n                <th>Actions</th>\n            </tr>\n            \n            {programList.map((item, key) => {\n                return (            \n                <tr>\n                    <td>\n                        <p>{item.program}</p>\n                    </td>\n                    <td>\n                        <p>{item.username}</p>\n                    </td>\n                    <td>\n                        <p>{item.password}</p>\n                    </td>\n                    <td>\n                    <Button className=\"edit-btn\" block bsSize=\"large\" onClick={() => updateCredentials(key)}>\n                        edit\n                    </Button>\n                    <Button className=\"delete-btn\" block bsSize=\"large\" onClick={() => deleteCredentials(key)}>\n                        delete\n                    </Button>\n                    </td>\n                </tr>\n                )\n            })}\n    </table>\n    )\n}\n\nconst Field = ({label =\"\", name=\"\", value=\"\", onChange}) =>{\n        return(<div className=\"field-set\">\n            <label className=\"field-label\" htmlFor={name}>{label}</label>\n            <input className=\"field-input\" type=\"text\" name={name} value={value} onChange={onChange}/>\n        </div>\n        )}\n\nconst Form = ({ formState, onChange, onSubmit, validateForm }) => {\n\n    return (\n        <form className=\"form\" onSubmit={onSubmit}>\n            <fieldset>\n                <Field \n                    name=\"program\"\n                    label=\"Program\"\n                    value={formState.program}\n                    onChange={onChange}\n                />\n                <Field \n                    name=\"username\"\n                    label=\"Username\"\n                    value={formState.username}\n                    onChange={onChange}\n                />\n                <Field \n                    name=\"password\"\n                    label=\"Password\"\n                    value={formState.password}\n                    onChange={onChange}\n                />\n                <Field \n                    name=\"password_re\"\n                    label=\"Password again\"\n                    value={formState.password_re}\n                    onChange={onChange}\n                />\n            </fieldset>\n            <div className=\"button-group\">\n                <Button type={formState.mode}>\n                    {formState.mode}\n                </Button>\n            </div>\n        </form>\n    )      \n}\n    \nexport default ProgramsList"]},"metadata":{},"sourceType":"module"}